<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connect Wallet</title>
    <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.7.3/dist/umd/index.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
        }
        button {
            font-size: 18px;
            padding: 10px 20px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Connect Your Wallet</h1>
    <button id="connectWalletBtn">Connect Wallet</button>

    <script>
        // Function to handle WalletConnect login
        async function loginWithWalletConnect() {
            try {
                // Initialize WalletConnect Provider
                const provider = new WalletConnectProvider({
                    rpc: {
                        1: "https://mainnet.infura.io/v3/e19dd5612ad546b38b7d6993e4a1857f" // Ethereum Mainnet
                    },
                    qrcode: true, // Show QR code
                });

                // Enable session (opens QR code modal)
                await provider.enable();

                // Create a new Web3 instance with the provider
                const web3 = new Web3(provider);

                // Get the user's account address
                const accounts = await web3.eth.getAccounts();
                const walletAddress = accounts[0];

                console.log("Wallet connected:", walletAddress);

                // Send wallet address back to Telegram bot
                window.Telegram.WebApp.sendData(walletAddress);

                // Close the Telegram mini-app
                window.Telegram.WebApp.close();
            } catch (error) {
                console.error("Wallet connection failed:", error);
            }
        }

        // Event listener for the "Connect Wallet" button
        document.getElementById("connectWalletBtn").addEventListener("click", loginWithWalletConnect);
    </script>
</body>
</html>
